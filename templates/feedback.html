<!-- templates/feedback.html -->
{% extends "base.html" %}
{% block content %}
<div style="padding-left:30px;">
<h2>Citizen Feedback</h2>
<p>Send suggestions or report issues with projects.</p>
</div>
<div class="feedback-container">
  <!-- General Feedback Section -->
  <div class="feedback-section">
    <h3>Submit General Feedback</h3>
    <form method="post" class="form">
      <input type="hidden" name="feedback_type" value="general">
      <div class="form-row">
        <input type="text" name="name" placeholder="Your name (optional)">
        <input type="email" name="email" placeholder="Email (optional)">
      </div>
      <div class="form-row">
        <textarea name="message" rows="5" placeholder="Your message" required></textarea>
      </div>
      <div class="form-row">
        <button class="btn" type="submit">Submit Feedback</button>
      </div>
    </form>
  </div>

  <!-- Project Report Section -->
  <div class="feedback-section">
    <h3>Report a Project</h3>
    <form method="post" class="form">
      <input type="hidden" name="feedback_type" value="report">
      <div class="form-row">
        <select name="project_id" required>
          <option value="">Select a Project to Report</option>
          {% for project in projects %}
          <option value="{{ project.project_id }}">{{ project.project_name }} ({{ project.sector_name or 'N/A' }})</option>
          {% endfor %}
        </select>
      </div>
      <div class="form-row">
        <input type="text" name="reporter_name" placeholder="Your name (optional)">
        <input type="email" name="reporter_email" placeholder="Email (optional)">
      </div>
      <div class="form-row">
        <input type="text" name="report_subject" placeholder="Report subject" required>
      </div>
      <div class="form-row">
        <select name="report_type">
          <option value="General">General Report</option>
          <option value="Issue">Issue</option>
          <option value="Concern">Concern</option>
          <option value="Suggestion">Suggestion</option>
        </select>
      </div>
      <div class="form-row">
        <textarea name="report_message" rows="5" placeholder="Describe your report in detail" required></textarea>
      </div>
      <div class="form-row">
        <button class="btn" type="submit">Submit Report</button>
      </div>
    </form>
  </div>
</div>

<!-- Feedback Carousel -->
<section class="feedback-carousel-section">
  <h2>Recent Citizen Feedback</h2>
  <div class="feedback-carousel">
    <div class="feedback-carousel-track" id="feedbackTrack">
      {% for feedback in recent %}
      <div class="feedback-carousel-item">
        <div class="feedback-item-header">
          <div class="feedback-item-avatar">
            <span>{{ feedback.name[0].upper() if feedback.name else 'A' }}</span>
          </div>
          <div class="feedback-item-info">
            <p class="feedback-name">{{ feedback.name or 'Anonymous' }}</p>
            <span class="feedback-role">{{ feedback.role.capitalize() if feedback.role else 'Citizen' }}</span>
          </div>
        </div>
        <p class="feedback-message">{{ feedback.message }}</p>
        <p class="feedback-date">{{ feedback.created_at.strftime('%B %d, %Y') if feedback.created_at else 'Recently' }}</p>
      </div>
      {% endfor %}
      <!-- Duplicate items for infinite scroll effect -->
      {% for feedback in recent %}
      <div class="feedback-carousel-item">
        <div class="feedback-item-header">
          <div class="feedback-item-avatar">
            <span>{{ feedback.name[0].upper() if feedback.name else 'A' }}</span>
          </div>
          <div class="feedback-item-info">
            <p class="feedback-name">{{ feedback.name or 'Anonymous' }}</p>
          </div>
        </div>
        <p class="feedback-message">{{ feedback.message }}</p>
        <p class="feedback-date">{{ feedback.created_at.strftime('%B %d, %Y') if feedback.created_at else 'Recently' }}</p>
      </div>
      {% endfor %}
    </div>
  </div>
</section>
{% endblock %}
