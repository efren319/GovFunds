# GovFunds Database Entity-Relationship Diagram (ERD)

## Visual Representation

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                          DATABASE ENTITIES & RELATIONSHIPS                  │
└─────────────────────────────────────────────────────────────────────────────┘

                                    ┌──────────────┐
                                    │     USER     │
                                    ├──────────────┤
                                    │ id (PK)      │
                                    │ username *   │
                                    │ password *   │
                                    │ role *       │
                                    └──────────────┘
                                           │
                                           │ (Admin manages)
                                           │
                    ┌──────────────────────┼──────────────────────┐
                    │                      │                      │
                    ▼                      ▼                      ▼
        ┌─────────────────────┐  ┌──────────────────┐  ┌──────────────┐
        │      PROJECT        │  │  PROJECT_REPORT  │  │   FEEDBACK   │
        ├─────────────────────┤  ├──────────────────┤  ├──────────────┤
        │ id (PK) *           │◄─┤ id (PK)          │  │ id (PK)      │
        │ name *              │  │ project_id (FK)* │  │ name         │
        │ project_sector *    │  │ reporter_name    │  │ email        │
        │ description         │  │ reporter_email   │  │ message *    │
        │ allocated_budget    │  │ report_subject * │  │ created_at   │
        │ spent               │  │ report_message * │  └──────────────┘
        │ status              │  │ report_type      │
        │ region              │  │ is_resolved      │
        │ start_date          │  │ created_at       │
        │ end_date            │  └──────────────────┘
        └─────────────────────┘
                    │
                    │ (Referenced by)
                    │
        ┌───────────┴───────────┐
        │                       │
        ▼                       ▼
┌──────────────────────┐ ┌──────────────────────┐
│   REGION_BUDGET      │ │ PROJECT_SECTOR_BUDGET│
├──────────────────────┤ ├──────────────────────┤
│ id (PK)              │ │ id (PK)              │
│ region *             │ │ sector *             │
│ year *               │ │ year *               │
│ budget *             │ │ budget *             │
│ (unique: region,year)│ └──────────────────────┘
└──────────────────────┘          │
        │                         │
        └──────────────┬──────────┘
                       │
                       ▼
            ┌──────────────────────┐
            │   ANNUAL_BUDGET      │
            ├──────────────────────┤
            │ id (PK)              │
            │ year * (unique)      │
            │ total_budget *       │
            └──────────────────────┘

* = NOT NULL / REQUIRED
PK = Primary Key
FK = Foreign Key
```

---

## Entity Descriptions

### 1. **USER**
Stores administrator and user accounts for the system.
- **Primary Key**: `id`
- **Fields**: username (unique), password (hashed), role

### 2. **PROJECT**
Government infrastructure projects with budget tracking.
- **Primary Key**: `id`
- **Key Fields**: name, project_sector, region, allocated_budget, spent, status
- **Relationships**: One-to-many with ProjectReport (one project → many reports)

### 3. **PROJECT_REPORT**
Complaints, issues, and suggestions about specific projects.
- **Primary Key**: `id`
- **Foreign Key**: `project_id` → references Project.id
- **Key Fields**: report_subject, report_message, is_resolved, report_type
- **Cascade**: Delete reports when project is deleted

### 4. **FEEDBACK**
General feedback/inquiries from citizens (not tied to specific projects).
- **Primary Key**: `id`
- **Key Fields**: name, email, message, created_at

### 5. **REGION_BUDGET**
Annual budget allocation for each of the 17 regions.
- **Primary Key**: `id`
- **Unique Constraint**: (region, year) - one budget per region per year
- **Key Fields**: region, year, budget amount

### 6. **PROJECT_SECTOR_BUDGET**
Annual budget allocation for 8 infrastructure sectors.
- **Primary Key**: `id`
- **Key Fields**: sector (Road, Bridge, Flood Control, etc.), year, budget

### 7. **ANNUAL_BUDGET**
Total annual government budget for all infrastructure.
- **Primary Key**: `id`
- **Unique Field**: year (one entry per year)
- **Key Fields**: total_budget

---

## Relationships Summary

| From | To | Type | Description |
|------|-----|------|-------------|
| PROJECT | PROJECT_REPORT | 1:N | One project has many reports |
| REGION_BUDGET | ANNUAL_BUDGET | N:1 | Many regions' budgets roll up to annual total |
| PROJECT_SECTOR_BUDGET | ANNUAL_BUDGET | N:1 | Many sectors' budgets roll up to annual total |
| USER | All Tables | - | Admins manage data, no FK constraints |

---

## Key Design Decisions

1. **No Foreign Keys for Budget Tables**: RegionBudget and ProjectSectorBudget don't have FK constraints to AnnualBudget because they're calculated independently. The total is computed in the app logic.

2. **Cascade Delete**: When a Project is deleted, all its ProjectReports are automatically deleted.

3. **Unique Constraint on RegionBudget**: Prevents duplicate budget entries for the same region in the same year.

4. **Flexible Report Types**: ProjectReport supports multiple report types (General, Issue, Concern, Suggestion) using string enum.

5. **Date Storage as String**: Project start_date and end_date are stored as strings for simplicity (could be upgraded to proper DateTime fields).

---

## Sample Data Summary

- **4 Projects** across 4 regions and sectors
- **51 Regional Budgets** (17 regions × 3 years: 2023-2025)
- **24 Project Sector Budgets** (8 sectors × 3 years: 2023-2025)
- **3 Annual Budgets** (2023, 2024, 2025)
- **2 Feedback Entries**
- **Multiple Project Reports** with resolution tracking
