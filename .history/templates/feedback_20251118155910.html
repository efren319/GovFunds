<!-- templates/feedback.html -->
{% extends "base.html" %}
{% block content %}
<h2>Citizen Feedback</h2>
<p>Send suggestions or report issues with projects.</p>

<div class="feedback-container">
  <!-- General Feedback Section -->
  <div class="feedback-section">
    <h3>Submit General Feedback</h3>
    <form method="post" class="form">
      <input type="hidden" name="feedback_type" value="general">
      <div class="form-row">
        <input type="text" name="name" placeholder="Your name (optional)">
        <input type="email" name="email" placeholder="Email (optional)">
      </div>
      <div class="form-row">
        <select name="role" required>
          <option value="">Select your role</option>
          <option value="student">Student</option>
          <option value="teacher">Teacher</option>
          <option value="parent">Parent</option>
          <option value="official">Government Official</option>
          <option value="citizen">Citizen</option>
        </select>
      </div>
      <div class="form-row">
        <textarea name="message" rows="5" placeholder="Your message" required></textarea>
      </div>
      <div class="form-row">
        <button class="btn" type="submit">Submit Feedback</button>
      </div>
    </form>
  </div>

  <!-- Project Report Section -->
  <div class="feedback-section">
    <h3>Report a Project</h3>
    <form method="post" class="form">
      <input type="hidden" name="feedback_type" value="report">
      <div class="form-row">
        <select name="project_id" required>
          <option value="">Select a Project to Report</option>
          {% for project in projects %}
          <option value="{{ project.id }}">{{ project.name }} ({{ project.department }})</option>
          {% endfor %}
        </select>
      </div>
      <div class="form-row">
        <input type="text" name="reporter_name" placeholder="Your name (optional)">
        <input type="email" name="reporter_email" placeholder="Email (optional)">
      </div>
      <div class="form-row">
        <select name="role" required>
          <option value="">Select your role</option>
          <option value="student">Student</option>
          <option value="teacher">Teacher</option>
          <option value="parent">Parent</option>
          <option value="official">Government Official</option>
          <option value="citizen">Citizen</option>
        </select>
      </div>
      <div class="form-row">
        <input type="text" name="report_subject" placeholder="Report subject" required>
      </div>
      <div class="form-row">
        <select name="report_type">
          <option value="General">General Report</option>
          <option value="Issue">Issue</option>
          <option value="Concern">Concern</option>
          <option value="Suggestion">Suggestion</option>
        </select>
      </div>
      <div class="form-row">
        <textarea name="report_message" rows="5" placeholder="Describe your report in detail" required></textarea>
      </div>
      <div class="form-row">
        <button class="btn" type="submit">Submit Report</button>
      </div>
    </form>
  </div>
</div>

<h3>Recent Feedback</h3>
<ul class="feedback-list">
  {% for f in recent %}
  <li>
    <div class="f-meta"><strong>{{ f['name'] or 'Anonymous' }}</strong> â€” <span class="muted">{{ f['created_at'] }}</span></div>
    <div class="f-msg">{{ f['message'] }}</div>
  </li>
  {% endfor %}
</ul>
{% endblock %}
